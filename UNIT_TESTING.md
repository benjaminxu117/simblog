# SimBlog å•å…ƒæµ‹è¯•è¯´æ˜

## ğŸ“‹ æµ‹è¯•æ¦‚è¿°

æˆ‘ä»¬å·²ç»ä¸ºSimBlogé¡¹ç›®çš„æ ¸å¿ƒç»„ä»¶åˆ›å»ºäº†å®Œæ•´çš„å•å…ƒæµ‹è¯•å¥—ä»¶ï¼Œç¡®ä¿ä»£ç è´¨é‡å’ŒåŠŸèƒ½æ­£ç¡®æ€§ã€‚

## ğŸ§ª å·²åˆ›å»ºçš„æµ‹è¯•

### 1. **æœåŠ¡å±‚æµ‹è¯•**
- âœ… `UserServiceTest.java` - ç”¨æˆ·æœåŠ¡æµ‹è¯•
- âœ… `ArticleServiceTest.java` - æ–‡ç« æœåŠ¡æµ‹è¯•  
- âœ… `AsyncServiceTest.java` - å¼‚æ­¥æœåŠ¡æµ‹è¯•

### 2. **é›†æˆæµ‹è¯•**
- âœ… `SimblogApplicationTests.java` - Spring Bootåº”ç”¨å¯åŠ¨æµ‹è¯•

### 3. **æµ‹è¯•é…ç½®**
- âœ… `application-test.yml` - æµ‹è¯•ç¯å¢ƒé…ç½®
- âœ… `data.sql` - æµ‹è¯•æ•°æ®åˆå§‹åŒ–è„šæœ¬

## ğŸ”§ æµ‹è¯•ç¯å¢ƒé…ç½®

### æµ‹è¯•æ•°æ®åº“
- **ç±»å‹**: H2å†…å­˜æ•°æ®åº“
- **é…ç½®**: `jdbc:h2:mem:testdb`
- **ä¼˜åŠ¿**: å¿«é€Ÿå¯åŠ¨ï¼Œæ— éœ€å¤–éƒ¨ä¾èµ–

### æµ‹è¯•é…ç½®ç‰¹ç‚¹
```yaml
# ä½¿ç”¨éšæœºç«¯å£é¿å…å†²çª
server:
  port: 0

# H2å†…å­˜æ•°æ®åº“
spring:
  datasource:
    driver-class-name: org.h2.Driver
    url: jdbc:h2:mem:testdb

# ä½¿ç”¨ä¸åŒçš„Redisæ•°æ®åº“
redis:
  database: 1
```

## ğŸ“Š æµ‹è¯•è¦†ç›–èŒƒå›´

### 1. **ç”¨æˆ·æœåŠ¡æµ‹è¯•** (`UserServiceTest`)
- âœ… ç”¨æˆ·æ³¨å†ŒæˆåŠŸ/å¤±è´¥åœºæ™¯
- âœ… ç”¨æˆ·ç™»å½•æˆåŠŸ/å¤±è´¥åœºæ™¯
- âœ… ç”¨æˆ·åæŸ¥æ‰¾
- âœ… ç”¨æˆ·ä¿¡æ¯æ›´æ–°
- âœ… å¯†ç åŠ å¯†éªŒè¯
- âœ… å¼‚æ­¥æ“ä½œéªŒè¯

### 2. **æ–‡ç« æœåŠ¡æµ‹è¯•** (`ArticleServiceTest`)
- âœ… æ–‡ç« åˆ†é¡µæŸ¥è¯¢
- âœ… æ–‡ç« è¯¦æƒ…è·å–
- âœ… æ–‡ç« åˆ›å»º/æ›´æ–°/åˆ é™¤
- âœ… æµè§ˆé‡ç»Ÿè®¡
- âœ… Redisç¼“å­˜æ“ä½œ
- âœ… å¼‚æ­¥æ‘˜è¦ç”Ÿæˆ

### 3. **å¼‚æ­¥æœåŠ¡æµ‹è¯•** (`AsyncServiceTest`)
- âœ… é‚®ä»¶å‘é€å¼‚æ­¥å¤„ç†
- âœ… æ–‡ä»¶ä¸Šä¼ å¼‚æ­¥å¤„ç†
- âœ… ç»Ÿè®¡æ•°æ®å¼‚æ­¥æ›´æ–°
- âœ… ç”¨æˆ·è¡Œä¸ºæ—¥å¿—è®°å½•
- âœ… ç¼“å­˜æ¸…ç†ä»»åŠ¡
- âœ… æ–‡ç« æ‘˜è¦ç”Ÿæˆ

## ğŸš€ è¿è¡Œæµ‹è¯•

### 1. **è¿è¡Œæ‰€æœ‰æµ‹è¯•**
```bash
mvn test
```

### 2. **è¿è¡Œç‰¹å®šæµ‹è¯•ç±»**
```bash
mvn test -Dtest=UserServiceTest
```

### 3. **è¿è¡Œæµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š**
```bash
mvn surefire-report:report
```

### 4. **ä½¿ç”¨æµ‹è¯•è„šæœ¬**
```bash
run-tests.bat
```

## ğŸ“ˆ æµ‹è¯•æŠ¥å‘Š

### æµ‹è¯•æŠ¥å‘Šä½ç½®
- **SurefireæŠ¥å‘Š**: `target/site/surefire-report.html`
- **æµ‹è¯•ç»“æœ**: `target/surefire-reports/`
- **è¦†ç›–ç‡æŠ¥å‘Š**: `target/site/jacoco/`

### æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
```bash
# ç”ŸæˆHTMLæŠ¥å‘Š
mvn surefire-report:report

# æ‰“å¼€æŠ¥å‘Š
start target/site/surefire-report.html
```

## ğŸ¯ æµ‹è¯•æœ€ä½³å®è·µ

### 1. **æµ‹è¯•å‘½åè§„èŒƒ**
```java
@Test
void testMethodName_Scenario_ExpectedResult() {
    // Given - å‡†å¤‡æµ‹è¯•æ•°æ®
    // When - æ‰§è¡Œè¢«æµ‹è¯•æ–¹æ³•
    // Then - éªŒè¯ç»“æœ
}
```

### 2. **Mockä½¿ç”¨è§„èŒƒ**
```java
@Mock
private UserService userService;

@InjectMocks
private UserController userController;

@Test
void testMethod() {
    // Given
    when(userService.method(any())).thenReturn(expectedResult);
    
    // When
    Result result = userController.method(input);
    
    // Then
    verify(userService).method(input);
    assertEquals(expectedResult, result);
}
```

### 3. **å¼‚æ­¥æµ‹è¯•å¤„ç†**
```java
@Test
void testAsyncMethod() {
    // å¼‚æ­¥æ–¹æ³•æµ‹è¯•ä¸»è¦éªŒè¯ï¼š
    // 1. æ–¹æ³•èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œ
    // 2. ä¸æŠ›å‡ºå¼‚å¸¸
    // 3. å¼‚æ­¥æ“ä½œè¢«æ­£ç¡®è°ƒç”¨
    
    asyncService.asyncMethod();
    
    // éªŒè¯å¼‚æ­¥æ“ä½œè¢«è°ƒç”¨
    verify(asyncService).asyncMethod();
}
```

## ğŸ” æµ‹è¯•æ•°æ®ç®¡ç†

### 1. **æµ‹è¯•æ•°æ®åˆå§‹åŒ–**
- ä½¿ç”¨`data.sql`è‡ªåŠ¨åˆå§‹åŒ–æµ‹è¯•æ•°æ®
- æ¯ä¸ªæµ‹è¯•æ–¹æ³•ä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®
- æµ‹è¯•å®Œæˆåè‡ªåŠ¨æ¸…ç†

### 2. **æµ‹è¯•æ•°æ®ç¤ºä¾‹**
```sql
-- æµ‹è¯•ç”¨æˆ·
INSERT INTO user (username, password, email) VALUES
('testuser', 'hashed_password', 'test@example.com');

-- æµ‹è¯•æ–‡ç« 
INSERT INTO article (title, content, author_id) VALUES
('Test Article', 'Test Content', 1);
```

## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. **æµ‹è¯•éš”ç¦»**
- æ¯ä¸ªæµ‹è¯•æ–¹æ³•ç‹¬ç«‹è¿è¡Œ
- ä½¿ç”¨`@BeforeEach`é‡ç½®æµ‹è¯•çŠ¶æ€
- é¿å…æµ‹è¯•é—´çš„æ•°æ®ä¾èµ–

### 2. **å¼‚æ­¥æµ‹è¯•**
- å¼‚æ­¥æ–¹æ³•çš„æµ‹è¯•ä¸»è¦éªŒè¯è°ƒç”¨
- å®é™…å¼‚æ­¥æ‰§è¡ŒéªŒè¯éœ€è¦é›†æˆæµ‹è¯•
- ä½¿ç”¨MockéªŒè¯å¼‚æ­¥æ“ä½œè¢«æ­£ç¡®è°ƒç”¨

### 3. **æ•°æ®åº“æµ‹è¯•**
- ä½¿ç”¨H2å†…å­˜æ•°æ®åº“é¿å…å¤–éƒ¨ä¾èµ–
- æµ‹è¯•æ•°æ®åœ¨æµ‹è¯•å®Œæˆåè‡ªåŠ¨æ¸…ç†
- æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®åº“çŠ¶æ€

## ğŸ“‹ æµ‹è¯•æ£€æŸ¥æ¸…å•

### å¼€å‘å‰
- [ ] ç†è§£ä¸šåŠ¡éœ€æ±‚
- [ ] è®¾è®¡æµ‹è¯•ç”¨ä¾‹
- [ ] å‡†å¤‡æµ‹è¯•æ•°æ®

### å¼€å‘ä¸­
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] è¿è¡Œæµ‹è¯•éªŒè¯
- [ ] ä¿®å¤æµ‹è¯•å¤±è´¥

### å¼€å‘å
- [ ] è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
- [ ] æ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡
- [ ] ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æµ‹è¯•ç¼–è¯‘å¤±è´¥**
   - æ£€æŸ¥ä¾èµ–æ˜¯å¦æ­£ç¡®
   - éªŒè¯æµ‹è¯•ä»£ç è¯­æ³•
   - ç¡®è®¤Mockå¯¹è±¡ç±»å‹åŒ¹é…

2. **æµ‹è¯•è¿è¡Œå¤±è´¥**
   - æ£€æŸ¥æµ‹è¯•æ•°æ®æ˜¯å¦æ­£ç¡®
   - éªŒè¯Mocké…ç½®
   - ç¡®è®¤æµ‹è¯•ç¯å¢ƒé…ç½®

3. **å¼‚æ­¥æµ‹è¯•é—®é¢˜**
   - ä½¿ç”¨`@Async`æ³¨è§£
   - é…ç½®æ­£ç¡®çš„çº¿ç¨‹æ± 
   - éªŒè¯å¼‚æ­¥æ–¹æ³•è°ƒç”¨

### è°ƒè¯•æŠ€å·§
```java
// å¯ç”¨è¯¦ç»†æ—¥å¿—
logging.level.com.example=DEBUG

// ä½¿ç”¨æ–­è¨€æ¶ˆæ¯
assertEquals("Expected message", actual, "Custom error message");

// éªŒè¯Mockè°ƒç”¨
verify(mockService, times(1)).method(any());
```

## ğŸ“ˆ æŒç»­æ”¹è¿›

### 1. **æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡**
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘: 90%+
- æ§åˆ¶å™¨å±‚: 80%+
- æœåŠ¡å±‚: 85%+
- å·¥å…·ç±»: 95%+

### 2. **æµ‹è¯•è´¨é‡æŒ‡æ ‡**
- æµ‹è¯•æ‰§è¡Œæ—¶é—´ < 30ç§’
- æµ‹è¯•ç¨³å®šæ€§ > 95%
- æµ‹è¯•å¯è¯»æ€§é«˜

### 3. **å®šæœŸç»´æŠ¤**
- æ¯æœˆæ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡
- å­£åº¦æ›´æ–°æµ‹è¯•ç”¨ä¾‹
- åŠæ—¶ä¿®å¤å¤±è´¥çš„æµ‹è¯• 